let e,t;function detach(){e&&(e.disconnect(),e=null),t&&(t.disconnect(),t=null)}export default function(o){const n={detach};"string"==typeof o&&o in n?n[o]():(o=>{const n=(o=o||{}).lazyClass||"lazy",i=o.lazyBackgroundClass||"lazy-bg",s="idleLoadTimeout"in o?o.idleLoadTimeout:200,a=o.observeChanges||!1,r=o.events||{},l=window,d="requestIdleCallback",c="IntersectionObserver",u=["srcset","src","poster"],f=[],b=(e,t)=>f.slice.call((t||document).querySelectorAll(e||"img."+n+",video."+n+",iframe."+n+",."+i)),g=e=>{const t=e.parentNode;let n,s=[];"PICTURE"==t.nodeName&&(n=t),"VIDEO"==e.nodeName&&(n=e),s=b("source",n);for(let e in s)h(s[e]);h(e),e.autoplay&&e.load();const a=e.classList;a.contains(i)&&(a.remove(i),a.add(o.lazyBackgroundLoaded||"lazy-bg-loaded"))},v=t=>{for(let e in r)t.addEventListener(e,r[e].listener||r[e],r[e].options||void 0);e.observe(t)},h=e=>{u.forEach(t=>{t in e.dataset&&l.requestAnimationFrame(()=>{e[t]=e.dataset[t]})})};let m=b();if(/baidu|(?:google|bing|yandex|duckduck)bot/i.test(navigator.userAgent))for(let e in m)g(m[e]);else if(c in l&&c+"Entry"in l){e=new l[c]((t,o)=>{t.forEach(t=>{if(t.intersectionRatio){const i=t.target;d in l&&s?l[d](()=>{g(i)},{timeout:s}):g(i),i.classList.remove(n),o.unobserve(i),(m=m.filter(e=>e!=i)).length||a||e.disconnect()}})},{rootMargin:("threshold"in o?o.threshold:200)+"px 0%"});for(let e in m)v(m[e]);a&&(t=new MutationObserver(()=>{b().forEach(e=>{m.indexOf(e)<0&&(m.push(e),v(e))})}).observe(b(o.observeRootSelector||"body")[0],o.mutationObserverOptions||{childList:!0,subtree:!0}))}})(o)}
